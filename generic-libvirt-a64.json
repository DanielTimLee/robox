{
  "variables": {
    "box_version": "{{env `VERSION`}}"
  },
  "provisioners": [
    {
      "scripts": [
        "scripts/gentoo/network.sh",
        "scripts/gentoo/emerge.sh"
      ],
      "type": "shell",
      "timeout": "720m",
      "start_retry_timeout": "15m",
      "expect_disconnect": "true",
      "only": [
        "generic-gentoo-libvirt-a64"
      ]
    },
    {
      "scripts": [
        "scripts/gentoo/virtualbox.sh",
        "scripts/gentoo/parallels.sh",
        "scripts/gentoo/vmware.sh",
        "scripts/gentoo/qemu.sh",
        "scripts/gentoo/vagrant.sh"
      ],
      "type": "shell",
      "timeout": "720m",
      "pause_before": "120s",
      "start_retry_timeout": "15m",
      "expect_disconnect": "true",
      "only": [
        "generic-gentoo-libvirt-a64"
      ]
    },
    {
      "scripts": [
        "scripts/ubuntu2204/apt.sh",
        "scripts/ubuntu2204/floppy.sh",
        "scripts/ubuntu2204/fixkvp.sh",
        "scripts/ubuntu2204/network.sh"
      ],
      "type": "shell",
      "timeout": "120m",
      "start_retry_timeout": "15m",
      "expect_disconnect": "true",
      "only": [
        "generic-ubuntu2204-libvirt-a64"
      ]
    },
    {
      "scripts": [
        "scripts/ubuntu2204/vagrant.sh",
        "scripts/ubuntu2204/profile.sh",
        "scripts/ubuntu2204/motd.sh",
        "scripts/ubuntu2204/fixtty.sh",
        "scripts/ubuntu2204/virtualbox.sh",
        "scripts/ubuntu2204/parallels.sh",
        "scripts/ubuntu2204/vmware.sh",
        "scripts/ubuntu2204/qemu.sh",
        "scripts/ubuntu2204/cleanup.sh"
      ],
      "type": "shell",
      "timeout": "120m",
      "pause_before": "120s",
      "start_retry_timeout": "15m",
      "expect_disconnect": "true",
      "only": [
        "generic-ubuntu2204-libvirt-a64"
      ]
    },
    {
      "scripts": [
        "scripts/openbsd7/pkg.sh"
      ],
      "type": "shell",
      "timeout": "120m",
      "start_retry_timeout": "15m",
      "expect_disconnect": "true",
      "execute_command": "{{.Vars}} /bin/sh {{ .Path }}",
      "only": [
        "generic-openbsd7-libvirt-a64"
      ]
    },
    {
      "scripts": [
        "scripts/openbsd7/hostname.sh",
        "scripts/openbsd7/motd.sh",
        "scripts/openbsd7/vagrant.sh",
        "scripts/openbsd7/profile.sh",
        "scripts/openbsd7/virtualbox.sh",
        "scripts/openbsd7/parallels.sh",
        "scripts/openbsd7/vmware.sh",
        "scripts/openbsd7/qemu.sh"
      ],
      "type": "shell",
      "timeout": "120m",
      "pause_before": "120s",
      "start_retry_timeout": "15m",
      "expect_disconnect": "true",
      "execute_command": "{{.Vars}} /usr/local/bin/bash {{ .Path }}",
      "only": [
        "generic-openbsd7-libvirt-a64"
      ]
    },
    {
      "type": "shell",
      "timeout": "120m",
      "scripts": [
        "scripts/rhel9/network.sh",
        "scripts/rhel9/dnf.sh",
        "scripts/rhel9/base.sh",
        "scripts/rhel9/reboot.sh"
      ],
      "execute_command": "{{.Vars}} /bin/bash '{{.Path}}'",
      "start_retry_timeout": "15m",
      "expect_disconnect": "true",
      "only": [
        "generic-rhel9-libvirt-a64"
      ]
    },
    {
      "type": "shell",
      "timeout": "120m",
      "scripts": [
        "scripts/rhel9/kernel.sh",
        "scripts/rhel9/floppy.sh",
        "scripts/rhel9/virtualbox.sh",
        "scripts/rhel9/parallels.sh",
        "scripts/rhel9/vmware.sh",
        "scripts/rhel9/qemu.sh",
        "scripts/rhel9/vagrant.sh",
        "scripts/rhel9/tuning.sh",
        "scripts/rhel9/sshd.sh",
        "scripts/rhel9/randomness.sh",
        "scripts/rhel9/updatedb.sh",
        "scripts/rhel9/cleanup.sh",
        "scripts/rhel9/undnf.sh"
      ],
      "execute_command": "{{.Vars}} /bin/bash '{{.Path}}'",
      "pause_before": "120s",
      "start_retry_timeout": "15m",
      "expect_disconnect": "true",
      "only": [
        "generic-rhel9-libvirt-a64"
      ]
    },
    {
      "type": "shell",
      "timeout": "120m",
      "scripts": [
        "scripts/alma9/network.sh",
        "scripts/alma9/dnf.sh",
        "scripts/alma9/base.sh",
        "scripts/alma9/reboot.sh"
      ],
      "execute_command": "{{.Vars}} /bin/bash '{{.Path}}'",
      "start_retry_timeout": "15m",
      "expect_disconnect": "true",
      "only": [
        "generic-alma9-libvirt-a64"
      ]
    },
    {
      "type": "shell",
      "timeout": "120m",
      "scripts": [
        "scripts/alma9/kernel.sh",
        "scripts/alma9/floppy.sh",
        "scripts/alma9/virtualbox.sh",
        "scripts/alma9/parallels.sh",
        "scripts/alma9/vmware.sh",
        "scripts/alma9/qemu.sh",
        "scripts/alma9/vagrant.sh",
        "scripts/alma9/tuning.sh",
        "scripts/alma9/sshd.sh",
        "scripts/alma9/randomness.sh",
        "scripts/alma9/updatedb.sh",
        "scripts/alma9/cleanup.sh",
        "scripts/alma9/undnf.sh"
      ],
      "execute_command": "{{.Vars}} /bin/bash '{{.Path}}'",
      "pause_before": "120s",
      "start_retry_timeout": "15m",
      "expect_disconnect": "true",
      "only": [
        "generic-alma9-libvirt-a64"
      ]
    },
    {
      "type": "shell",
      "timeout": "120m",
      "scripts": [
        "scripts/fedora38/fixdns.sh",
        "scripts/fedora38/hostname.sh",
        "scripts/fedora38/dnf.sh"
      ],
      "start_retry_timeout": "15m",
      "expect_disconnect": "true",
      "only": [
        "generic-fedora38-libvirt-a64"
      ]
    },
    {
      "type": "shell",
      "timeout": "120m",
      "scripts": [
        "scripts/fedora38/fixtmp.sh",
        "scripts/fedora38/base.sh"
      ],
      "pause_before": "120s",
      "start_retry_timeout": "15m",
      "expect_disconnect": "true",
      "only": [
        "generic-fedora38-libvirt-a64"
      ]
    },
    {
      "type": "shell",
      "timeout": "120m",
      "scripts": [
        "scripts/fedora38/kernel.sh",
        "scripts/fedora38/updatedb.sh",
        "scripts/fedora38/vga.sh",
        "scripts/fedora38/virtualbox.sh",
        "scripts/fedora38/parallels.sh",
        "scripts/fedora38/vmware.sh",
        "scripts/fedora38/qemu.sh",
        "scripts/fedora38/vagrant.sh",
        "scripts/fedora38/tuning.sh",
        "scripts/fedora38/cleanup.sh"
      ],
      "pause_before": "120s",
      "start_retry_timeout": "15m",
      "expect_disconnect": "true",
      "only": [
        "generic-fedora38-libvirt-a64"
      ]
    },
    {
      "scripts": [
        "scripts/debian12/apt.sh",
        "scripts/debian12/network.sh"
      ],
      "type": "shell",
      "timeout": "120m",
      "start_retry_timeout": "15m",
      "expect_disconnect": "true",
      "only": [
        "generic-debian12-libvirt-a64"
      ]
    },
    {
      "scripts": [
        "scripts/debian12/floppy.sh",
        "scripts/debian12/profile.sh",
        "scripts/debian12/vagrant.sh",
        "scripts/debian12/motd.sh",
        "scripts/debian12/fixtty.sh",
        "scripts/debian12/virtualbox.sh",
        "scripts/debian12/parallels.sh",
        "scripts/debian12/vmware.sh",
        "scripts/debian12/qemu.sh",
        "scripts/debian12/cleanup.sh"
      ],
      "type": "shell",
      "timeout": "120m",
      "pause_before": "120s",
      "start_retry_timeout": "15m",
      "expect_disconnect": "true",
      "only": [
        "generic-debian12-libvirt-a64"
      ]
    },
    {
      "type": "shell",
      "timeout": "120m",
      "scripts": [
        "scripts/alpine318/network.sh",
        "scripts/alpine318/apk.sh"
      ],
      "execute_command": "/bin/sh '{{.Path}}'",
      "start_retry_timeout": "15m",
      "expect_disconnect": "true",
      "only": [
        "generic-alpine318-libvirt-a64"
      ]
    },
    {
      "type": "shell",
      "timeout": "120m",
      "scripts": [
        "scripts/alpine318/hostname.sh",
        "scripts/alpine318/lsb.sh",
        "scripts/alpine318/floppy.sh",
        "scripts/alpine318/vagrant.sh",
        "scripts/alpine318/sshd.sh",
        "scripts/alpine318/virtualbox.sh",
        "scripts/alpine318/parallels.sh",
        "scripts/alpine318/vmware.sh",
        "scripts/alpine318/qemu.sh",
        "scripts/alpine318/cache.sh"
      ],
      "execute_command": "{{.Vars}} /bin/bash '{{.Path}}'",
      "pause_before": "120s",
      "start_retry_timeout": "15m",
      "expect_disconnect": "true",
      "only": [
        "generic-alpine318-libvirt-a64"
      ]
    },
    {
      "scripts": [
        "scripts/freebsd14/pkg.sh",
        "scripts/freebsd14/hostname.sh",
        "scripts/freebsd14/kernel.sh",
        "scripts/freebsd14/firstboot.sh",
        "scripts/freebsd14/motd.sh",
        "scripts/freebsd14/vagrant.sh",
        "scripts/freebsd14/virtualbox.sh",
        "scripts/freebsd14/parallels.sh",
        "scripts/freebsd14/vmware.sh",
        "scripts/freebsd14/qemu.sh",
        "scripts/freebsd14/cleanup.sh"
      ],
      "type": "shell",
      "timeout": "120m",
      "start_retry_timeout": "15m",
      "expect_disconnect": "true",
      "execute_command": "{{.Vars}} /usr/local/bin/bash {{ .Path }}",
      "only": [
        "generic-freebsd14-libvirt-a64"
      ]
    },
    {
      "scripts": [
        "scripts/common/motd.sh",
        "scripts/common/keys.sh",
        "scripts/common/machine.sh",
        "scripts/common/leases.sh",
        "scripts/common/localtime.sh"
      ],
      "type": "shell",
      "timeout": "120m",
      "start_retry_timeout": "15m",
      "expect_disconnect": "true"
    },
    {
      "scripts": [
        "scripts/common/zerodisk.sh"
      ],
      "type": "shell",
      "timeout": "720m",
      "start_retry_timeout": "15m",
      "expect_disconnect": "true"
    },
    {
      "scripts": [
        "scripts/common/lockout.sh"
      ],
      "type": "shell",
      "timeout": "120m",
      "start_retry_timeout": "15m",
      "expect_disconnect": "true"
    }
  ],
  "builders": [
    {
      "type": "qemu",
      "name": "generic-gentoo-libvirt-a64",
      "vm_name": "generic-gentoo-libvirt-a64",
      "output_directory": "output/generic-gentoo-libvirt-a64",
      "qemu_binary": "qemu-system-aarch64",
      "cpu_model": "max",
      "boot_wait": "180s",
      "boot_keygroup_interval": "1s",
      "boot_command": [
        "sed -i 's/min=.*/min=1,1,1,1,1/g' /etc/security/passwdqc.conf<enter><wait>",
        "passwd root<enter><wait><wait><wait>",
        "vagrant<enter><wait>",
        "vagrant<enter><wait>",
        "curl -O 'http://{{ .HTTPIP }}:{{ .HTTPPort }}/generic.gentoo.vagrant{,.chroot}.sh'<enter><wait>",
        "bash generic.gentoo.vagrant.sh<enter>"
      ],
      "qemuargs": [
        [
          "-display",
          "gtk"
        ],
        [
          "-device",
          "ramfb"
        ],
        [
          "-machine",
          "virt,gic-version=3,dump-guest-core=off,memory-backend=mach-virt.ram,acpi=on,usb=on"
        ],
        [
          "-object",
          "{'qom-type':'memory-backend-ram','id':'mach-virt.ram','size':4294967296}"
        ],
        [
          "-overcommit",
          "mem-lock=off"
        ],
        [
          "-accel",
          "tcg"
        ],
        [
          "-boot",
          "order=cd,strict=off,menu=off"
        ],
        [
          "-device",
          "qemu-xhci"
        ],
        [
          "-device", 
          "{'driver':'usb-kbd','id':'input0'}"
        ]
      ],
      "efi_boot": true,
      "efi_firmware_code": "/usr/share/edk2/aarch64/QEMU_EFI-silent-pflash.raw",
      "efi_firmware_vars": "/usr/share/edk2/aarch64/vars-template-pflash.raw",
      "format": "qcow2",
      "disk_size": "131072",
      "disk_discard": "unmap",
      "disk_detect_zeroes": "on",
      "disk_cache": "unsafe",
      "disk_image": false,
      "disk_compression": true,
      "disk_interface": "virtio",
      "net_device": "virtio-net",
      "cpus": 4,
      "memory": 4096,
      "http_directory": "http",
      "headless": true,
      "iso_url": "https://mirrors.edge.kernel.org/gentoo/releases/arm64/autobuilds/current-install-arm64-minimal/install-arm64-minimal-20231105T230202Z.iso",
      "iso_checksum": "sha256:87b974fa75a2e34ed638e5b0358abee9c31fb0b23c054b4bf10bb766d65608a0",
      "ssh_username": "root",
      "ssh_password": "vagrant",
      "ssh_port": 22,
      "ssh_handshake_attempts": 1000,
      "ssh_timeout": "9800s",
      "shutdown_command": "shutdown -hP now"
    },
    {
      "type": "qemu",
      "name": "generic-openbsd7-libvirt-a64",
      "vm_name": "generic-openbsd7-libvirt-a64",
      "output_directory": "output/generic-openbsd7-libvirt-a64",
      "qemu_binary": "qemu-system-aarch64",
      "cpu_model": "max",
      "boot_wait": "60s",
      "boot_keygroup_interval": "1s",
      "boot_command": [
        "S<enter><wait5>",
        "ifconfig vio0 group dhcp<enter><wait5>",
        "ifconfig vio0 inet autoconf<enter><wait10>",
        "ftp -o /install.conf http://{{.HTTPIP}}:{{.HTTPPort}}/generic.openbsd7.install.cfg<enter><wait5>",
        "ftp -o /install-chroot.sh http://{{.HTTPIP}}:{{.HTTPPort}}/generic.openbsd7.install.chroot.sh<enter><wait5>",
        "/install -a -f /install.conf -m install && chroot /mnt < /install-chroot.sh && reboot<enter>"
      ],
      "qemuargs": [
        [
          "-display",
          "gtk"
        ],
        [
          "-device",
          "ramfb"
        ],
        [
          "-machine",
          "virt,gic-version=3,dump-guest-core=off,memory-backend=mach-virt.ram,acpi=on,usb=on"
        ],
        [
          "-object",
          "{'qom-type':'memory-backend-ram','id':'mach-virt.ram','size':4294967296}"
        ],
        [
          "-overcommit",
          "mem-lock=off"
        ],
        [
          "-accel",
          "tcg"
        ],
        [
          "-boot",
          "order=cd,strict=off,menu=off"
        ],
        [
          "-device",
          "qemu-xhci"
        ],
        [
          "-device", 
          "{'driver':'usb-kbd','id':'input0'}"
        ]
      ],
      "efi_boot": true,
      "efi_firmware_code": "/usr/share/edk2/aarch64/QEMU_EFI-silent-pflash.raw",
      "efi_firmware_vars": "/usr/share/edk2/aarch64/vars-template-pflash.raw",
      "format": "qcow2",
      "disk_size": "131072",
      "disk_discard": "unmap",
      "disk_detect_zeroes": "on",
      "disk_cache": "unsafe",
      "disk_image": true,
      "disk_compression": true,
      "disk_interface": "virtio",
      "net_device": "virtio-net",
      "cpus": 4,
      "memory": 4096,
      "http_directory": "http",
      "headless": true,
      "iso_url": "https://cdn.openbsd.org/pub/OpenBSD/7.4/arm64/miniroot74.img",
      "iso_checksum": "sha256:7b08b2ce081cff6408d183f7152ddcfd2779912104866e4fdf6ae2d864b51142",
      "ssh_username": "root",
      "ssh_password": "vagrant",
      "ssh_port": 22,
      "ssh_handshake_attempts": 1000,
      "ssh_timeout": "3600s",
      "shutdown_command": "shutdown -h -p now"
    },
    {
      "type": "qemu",
      "name": "generic-ubuntu2204-libvirt-a64",
      "vm_name": "generic-ubuntu2204-libvirt-a64",
      "output_directory": "output/generic-ubuntu2204-libvirt-a64",
      "qemu_binary": "qemu-system-aarch64",
      "cpu_model": "max",
      "boot_wait": "10s",
      "boot_keygroup_interval": "1s",
      "boot_command": [
        "<tab><wait><tab><wait><tab><wait><tab><wait><tab><wait><tab><wait>",
        "<tab><wait><tab><wait><tab><wait><tab><wait><tab><wait><tab><wait>",
        "<tab><wait><tab><wait><tab><wait><tab><wait><tab><wait><tab><wait>",
        "<tab><wait><tab><wait><tab><wait><tab><wait><tab><wait><tab><wait>",
        "<tab><wait><tab><wait><tab><wait><tab><wait><tab><wait><tab><wait>",
        "<tab><wait><tab><wait><tab><wait><tab><wait><tab><wait><tab><wait>",
        "<tab><wait><tab><wait><tab><wait><tab><wait><tab><wait><tab><wait>",
        "<tab><wait><tab><wait><tab><wait><tab><wait><tab><wait><tab><wait>",
        "<tab><wait><tab><wait><tab><wait><tab><wait><tab><wait><tab><wait>",
        "<tab><wait><tab><wait><tab><wait><tab><wait><tab><wait><tab><wait>",
        "c<wait10>",
        "set gfxpayload=keep<enter><wait10>",
        "linux /casper/vmlinuz autoinstall quiet net.ifnames=0 biosdevname=0 ",
        "cloud-config-url=\"http://{{.HTTPIP}}:{{.HTTPPort}}/generic.ubuntu2204.vagrant.cfg\" --- <enter><wait10>",
        "initrd /casper/initrd<enter><wait10>",
        "boot<enter>"
      ],
      "qemuargs": [
        [
          "-display",
          "gtk"
        ],
        [
          "-device",
          "ramfb"
        ],
        [
          "-machine",
          "virt,gic-version=3,dump-guest-core=off,memory-backend=mach-virt.ram,acpi=on,usb=on"
        ],
        [
          "-object",
          "{'qom-type':'memory-backend-ram','id':'mach-virt.ram','size':4294967296}"
        ],
        [
          "-overcommit",
          "mem-lock=off"
        ],
        [
          "-accel",
          "tcg"
        ],
        [
          "-boot",
          "order=cd,strict=off,menu=off"
        ],
        [
          "-device",
          "qemu-xhci"
        ],
        [
          "-device", 
          "{'driver':'usb-kbd','id':'input0'}"
        ]
      ],
      "efi_boot": true,
      "efi_firmware_code": "/usr/share/edk2/aarch64/QEMU_EFI-silent-pflash.raw",
      "efi_firmware_vars": "/usr/share/edk2/aarch64/vars-template-pflash.raw",
      "format": "qcow2",
      "disk_size": "131072",
      "disk_discard": "unmap",
      "disk_detect_zeroes": "on",
      "disk_cache": "unsafe",
      "disk_image": false,
      "disk_compression": true,
      "disk_interface": "virtio",
      "net_device": "virtio-net",
      "cpus": 4,
      "memory": 4096,
      "http_directory": "http",
      "headless": true,
      "iso_url": "https://cdimage.ubuntu.com/releases/22.04.3/release/ubuntu-22.04.3-live-server-arm64.iso",
      "iso_checksum": "sha256:5702372d25111e24d59596de62ae24daef873018cbf63c9dd9ff12292a57aca9",
      "ssh_username": "root",
      "ssh_password": "vagrant",
      "ssh_port": 22,
      "ssh_handshake_attempts": 1000,
      "ssh_timeout": "3600s",
      "shutdown_command": "echo 'vagrant' | sudo -S shutdown -P now"
    },
    {
      "type": "qemu",
      "name": "generic-rhel9-libvirt-a64",
      "vm_name": "generic-rhel9-libvirt-a64",
      "output_directory": "output/generic-rhel9-libvirt-a64",
      "qemu_binary": "qemu-system-aarch64",
      "cpu_model": "max",
      "boot_wait": "20s",
      "boot_keygroup_interval": "1s",
      "boot_command": [
        "<tab> net.ifnames=0 inst.text inst.ks=http://{{ .HTTPIP }}:{{ .HTTPPort }}/generic.rhel9.vagrant.ks vga=792 <enter><wait>"
      ],
      "qemuargs": [
        [
          "-display",
          "gtk"
        ],
        [
          "-device",
          "ramfb"
        ],
        [
          "-machine",
          "virt,gic-version=3,dump-guest-core=off,memory-backend=mach-virt.ram,acpi=on,usb=on"
        ],
        [
          "-object",
          "{'qom-type':'memory-backend-ram','id':'mach-virt.ram','size':4294967296}"
        ],
        [
          "-overcommit",
          "mem-lock=off"
        ],
        [
          "-accel",
          "tcg"
        ],
        [
          "-boot",
          "order=cd,strict=off,menu=off"
        ],
        [
          "-device",
          "qemu-xhci"
        ],
        [
          "-device", 
          "{'driver':'usb-kbd','id':'input0'}"
        ]
      ],
      "efi_boot": true,
      "efi_firmware_code": "/usr/share/edk2/aarch64/QEMU_EFI-silent-pflash.raw",
      "efi_firmware_vars": "/usr/share/edk2/aarch64/vars-template-pflash.raw",
      "format": "qcow2",
      "disk_size": "131072",
      "disk_discard": "unmap",
      "disk_detect_zeroes": "on",
      "disk_cache": "unsafe",
      "disk_image": false,
      "disk_compression": true,
      "disk_interface": "virtio",
      "net_device": "virtio-net",
      "cpus": 4,
      "memory": 4096,
      "http_directory": "http",
      "headless": true,
      "iso_url": "https://archive.org/download/rhel-9.2/rhel-9.2-aarch64-dvd.iso",
      "iso_checksum": "sha256:e9079bb03f16da5421b62e912d7f12620d177bc0944f304645b2ecf722f5a146",
      "ssh_username": "root",
      "ssh_password": "vagrant",
      "ssh_port": 22,
      "ssh_handshake_attempts": 1000,
      "ssh_timeout": "3600s",
      "shutdown_command": "echo 'vagrant' | sudo -S shutdown -P now"
    },
    {
      "type": "qemu",
      "name": "generic-alma9-libvirt-a64",
      "vm_name": "generic-alma9-libvirt-a64",
      "output_directory": "output/generic-alma9-libvirt-a64",
      "qemu_binary": "qemu-system-aarch64",
      "cpu_model": "max",
      "boot_wait": "20s",
      "boot_keygroup_interval": "1s",
      "boot_command": [
        "<tab><wait10><tab><wait10><tab><wait10><tab>c<wait><enter>",
        "linux /images/pxeboot/vmlinuz ",
        "inst.stage2=hd:LABEL=AlmaLinux-9-2-aarch64-dvd ",
        "inst.ks=http://{{ .HTTPIP }}:{{ .HTTPPort }}/generic.alma9.vagrant.arm.ks ",
        "inst.text net.ifnames=0 biosdevname=0 vga=792<enter><wait10>",
        "initrd /images/pxeboot/initrd.img<enter><wait10>",
        "boot<enter><wait>"
      ],
      "qemuargs": [
        [
          "-display",
          "gtk"
        ],
        [
          "-device",
          "ramfb"
        ],
        [
          "-machine",
          "virt,gic-version=3,dump-guest-core=off,memory-backend=mach-virt.ram,acpi=on,usb=on"
        ],
        [
          "-object",
          "{'qom-type':'memory-backend-ram','id':'mach-virt.ram','size':4294967296}"
        ],
        [
          "-overcommit",
          "mem-lock=off"
        ],
        [
          "-accel",
          "tcg"
        ],
        [
          "-boot",
          "order=cd,strict=off,menu=off"
        ],
        [
          "-device",
          "qemu-xhci"
        ],
        [
          "-device", 
          "{'driver':'usb-kbd','id':'input0'}"
        ]
      ],
      "efi_boot": true,
      "efi_firmware_code": "/usr/share/edk2/aarch64/QEMU_EFI-silent-pflash.raw",
      "efi_firmware_vars": "/usr/share/edk2/aarch64/vars-template-pflash.raw",
      "format": "qcow2",
      "disk_size": "131072",
      "disk_discard": "unmap",
      "disk_detect_zeroes": "on",
      "disk_cache": "unsafe",
      "disk_image": false,
      "disk_compression": true,
      "disk_interface": "virtio",
      "net_device": "virtio-net",
      "cpus": 4,
      "memory": 4096,
      "http_directory": "http",
      "headless": true,
      "iso_url": "https://dfw.mirror.rackspace.com/almalinux/9.2/isos/aarch64/AlmaLinux-9.2-aarch64-boot.iso",
      "iso_checksum": "sha256:13f579bc653d1d182b36b85e1762e313fc6bb9827428f0d43115e141e3c38833",
      "ssh_username": "root",
      "ssh_password": "vagrant",
      "ssh_port": 22,
      "ssh_handshake_attempts": 1000,
      "ssh_timeout": "3600s",
      "shutdown_command": "echo 'vagrant' | sudo -S shutdown -P now"
    },
    {
      "type": "qemu",
      "name": "generic-fedora38-libvirt-a64",
      "vm_name": "generic-fedora38-libvirt-a64",
      "output_directory": "output/generic-fedora38-libvirt-a64",
      "qemu_binary": "qemu-system-aarch64",
      "cpu_model": "max",
      "boot_wait": "20s",
      "boot_keygroup_interval": "1s",
       "boot_command": [
        "<tab><wait10><tab><wait10><tab><wait10><tab>c<wait><enter>",
        "insmod all_video<enter><wait>",
        "linux /images/pxeboot/vmlinuz ",
        "inst.stage2=hd:LABEL=Fedora-S-dvd-aarch64k ",
        "inst.ks=http://{{ .HTTPIP }}:{{ .HTTPPort }}/generic.fedora38.vagrant.ks ",
        "inst.text net.ifnames=0 biosdevname=0 vga=792<enter><wait10>",
        "initrd /images/pxeboot/initrd.img<enter><wait10>",
        "boot<enter><wait>"
      ],
      "qemuargs": [
        [
          "-display",
          "gtk"
        ],
        [
          "-device",
          "ramfb"
        ],
        [
          "-machine",
          "virt,gic-version=3,dump-guest-core=off,memory-backend=mach-virt.ram,acpi=on,usb=on"
        ],
        [
          "-object",
          "{'qom-type':'memory-backend-ram','id':'mach-virt.ram','size':4294967296}"
        ],
        [
          "-overcommit",
          "mem-lock=off"
        ],
        [
          "-accel",
          "tcg"
        ],
        [
          "-boot",
          "order=cd,strict=off,menu=off"
        ],
        [
          "-device",
          "qemu-xhci"
        ],
        [
          "-device", 
          "{'driver':'usb-kbd','id':'input0'}"
        ]
      ],
      "efi_boot": true,
      "efi_firmware_code": "/usr/share/edk2/aarch64/QEMU_EFI-silent-pflash.raw",
      "efi_firmware_vars": "/usr/share/edk2/aarch64/vars-template-pflash.raw",
      "format": "qcow2",
      "disk_size": "131072",
      "disk_discard": "unmap",
      "disk_detect_zeroes": "on",
      "disk_cache": "unsafe",
      "disk_image": false,
      "disk_compression": true,
      "disk_interface": "virtio",
      "net_device": "virtio-net",
      "cpus": 4,
      "memory": 4096,
      "http_directory": "http",
      "headless": true,
      "iso_url": "https://dl.fedoraproject.org/pub/fedora/linux/releases/38/Server/aarch64/iso/Fedora-Server-netinst-aarch64-38-1.6.iso",
      "iso_checksum": "sha256:0cbc11231f3e27b3e29c88936d0eca289546f8c7eba53f39b81ea575ceba454a",
      "ssh_username": "root",
      "ssh_password": "vagrant",
      "ssh_port": 22,
      "ssh_handshake_attempts": 1000,
      "ssh_timeout": "3600s",
      "shutdown_command": "echo 'vagrant' | sudo -S shutdown -P now"
    },
    {
      "type": "qemu",
      "name": "generic-debian12-libvirt-a64",
      "vm_name": "generic-debian12-libvirt-a64",
      "output_directory": "output/generic-debian12-libvirt-a64",
      "qemu_binary": "qemu-system-aarch64",
      "cpu_model": "max",
      "boot_wait": "10s",
      "boot_keygroup_interval": "1s",
      "boot_command": [
        "<esc><wait><esc><wait><esc><wait><esc><wait><esc><wait><esc><wait>",
        "<esc><wait><esc><wait><esc><wait><esc><wait><esc><wait><esc><wait>",
        "<esc><wait><esc><wait><esc><wait><esc><wait><esc><wait><esc><wait>",
        "<esc><wait><esc><wait><esc><wait><esc><wait><esc><wait><esc><wait>",
        "<esc><wait><esc><wait><esc><wait><esc><wait><esc><wait><esc><wait>",
        "<esc><wait><esc><wait><esc><wait><esc><wait><esc><wait><esc><wait>",
        "<esc><wait><esc><wait><esc><wait><esc><wait><esc><wait><esc><wait>",
        "<esc><wait><esc><wait><esc><wait><esc><wait><esc><wait><esc><wait>",
        "<esc><wait><esc><wait><esc><wait><esc><wait><esc><wait><esc><wait>",
        "<esc><wait><esc><wait><esc><wait><esc><wait><esc><wait><esc><wait>c<wait><enter><wait>",
        "setparams 'Install'<enter><wait>",
        "set background_color=black<enter><wait>",
        "linux /install.a64/vmlinuz --- auto=true priority=critical ",
        "preseed/url=http://{{.HTTPIP}}:{{.HTTPPort}}/generic.debian12.vagrant.arm.cfg ",
        "ipv6.disable_ipv6=1 net.ifnames=0 biosdevname=0<enter><wait>",
        "initrd /install.a64/initrd.gz<enter><wait>",
        "boot<enter><wait>"
      ],
      "qemuargs": [
        [
          "-display",
          "gtk"
        ],
        [
          "-device",
          "ramfb"
        ],
        [
          "-machine",
          "virt,gic-version=3,dump-guest-core=off,memory-backend=mach-virt.ram,acpi=on,usb=on"
        ],
        [
          "-object",
          "{'qom-type':'memory-backend-ram','id':'mach-virt.ram','size':4294967296}"
        ],
        [
          "-overcommit",
          "mem-lock=off"
        ],
        [
          "-accel",
          "tcg"
        ],
        [
          "-boot",
          "order=cd,strict=off,menu=off"
        ],
        [
          "-device",
          "qemu-xhci"
        ],
        [
          "-device", 
          "{'driver':'usb-kbd','id':'input0'}"
        ]
      ],
      "efi_boot": true,
      "efi_firmware_code": "/usr/share/edk2/aarch64/QEMU_EFI-silent-pflash.raw",
      "efi_firmware_vars": "/usr/share/edk2/aarch64/vars-template-pflash.raw",
      "format": "qcow2",
      "disk_size": "131072",
      "disk_discard": "unmap",
      "disk_detect_zeroes": "on",
      "disk_cache": "unsafe",
      "disk_image": false,
      "disk_compression": true,
      "disk_interface": "virtio",
      "net_device": "virtio-net",
      "cpus": 4,
      "memory": 4096,
      "http_directory": "http",
      "headless": true,
      "iso_url": "https://cdimage.debian.org/cdimage/release/12.2.0/arm64/iso-cd/debian-12.2.0-arm64-netinst.iso",
      "iso_checksum": "sha256:7b8f2ff9bd422fc1cba7d5978bace17ecf48ba23842e7e7e13b0d8ba502a7556",
      "ssh_username": "root",
      "ssh_password": "vagrant",
      "ssh_port": 22,
      "ssh_handshake_attempts": 1000,
      "ssh_timeout": "9800s",
      "shutdown_command": "echo 'vagrant' | sudo -S shutdown -P now"
    },
    {
      "type": "qemu",
      "name": "generic-alpine318-libvirt-a64",
      "vm_name": "generic-alpine318-libvirt-a64",
      "output_directory": "output/generic-alpine318-libvirt-a64",
      "qemu_binary": "qemu-system-aarch64",
      "cpu_model": "max",
      "boot_wait": "240s",
      "boot_keygroup_interval": "1s",
      "boot_command": [
        "<enter><wait10>",
        "root<enter><wait>",
        "ifconfig eth0 up && udhcpc -i eth0<enter><wait>",
        "wget http://{{ .HTTPIP }}:{{ .HTTPPort }}/generic.alpine318.vagrant.cfg<enter><wait>",
        "sed -i -e \"/rc-service/d\" /sbin/setup-sshd<enter><wait>",
        "source generic.alpine318.vagrant.cfg<enter><wait>",
        "printf \"vagrant\\nvagrant\\n\" | sh /sbin/setup-alpine -f /root/generic.alpine318.vagrant.cfg && ",
        "mount /dev/vda2 /mnt && ",
        "sed -E -i '/#? ?PasswordAuthentication/d' /mnt/etc/ssh/sshd_config && ",
        "sed -E -i '/#? ?PermitRootLogin/d' /mnt/etc/ssh/sshd_config && ",
        "echo 'PasswordAuthentication yes' >> /mnt/etc/ssh/sshd_config && ",
        "echo 'PermitRootLogin yes' >> /mnt/etc/ssh/sshd_config && ",
        "chroot /mnt apk add openntpd && chroot /mnt rc-update add openntpd default && reboot<enter>"
      ],
      "qemuargs": [
        [
          "-display",
          "gtk"
        ],
        [
          "-device",
          "ramfb"
        ],
        [
          "-machine",
          "virt,gic-version=3,dump-guest-core=off,memory-backend=mach-virt.ram,acpi=on,usb=on"
        ],
        [
          "-object",
          "{'qom-type':'memory-backend-ram','id':'mach-virt.ram','size':4294967296}"
        ],
        [
          "-overcommit",
          "mem-lock=off"
        ],
        [
          "-accel",
          "tcg"
        ],
        [
          "-boot",
          "order=cd,strict=off,menu=off"
        ],
        [
          "-device",
          "qemu-xhci"
        ],
        [
          "-device", 
          "{'driver':'usb-kbd','id':'input0'}"
        ]
      ],
      "efi_boot": true,
      "efi_firmware_code": "/usr/share/edk2/aarch64/QEMU_EFI-silent-pflash.raw",
      "efi_firmware_vars": "/usr/share/edk2/aarch64/vars-template-pflash.raw",
      "format": "qcow2",
      "disk_size": "131072",
      "disk_discard": "unmap",
      "disk_detect_zeroes": "on",
      "disk_cache": "unsafe",
      "disk_image": false,
      "disk_compression": true,
      "disk_interface": "virtio",
      "net_device": "virtio-net",
      "cpus": 8,
      "memory": 4096,
      "http_directory": "http",
      "headless": true,
      "iso_url": "https://mirrors.edge.kernel.org/alpine/v3.18/releases/aarch64/alpine-virt-3.18.4-aarch64.iso",
      "iso_checksum": "sha256:ea9dcc55ae468e29999e99d01b95ae051c7ce6aef627149337d8319a94f9f071",
      "ssh_username": "root",
      "ssh_password": "vagrant",
      "ssh_port": 22,
      "ssh_handshake_attempts": 1000,
      "ssh_timeout": "3600s",
      "shutdown_command": "/sbin/poweroff"
    },
    {
      "type": "qemu",
      "name": "generic-freebsd14-libvirt-a64",
      "vm_name": "generic-freebsd14-libvirt-a64",
      "output_directory": "output/generic-freebsd14-libvirt-a64",
      "qemu_binary": "qemu-system-aarch64",
      "cpu_model": "max",
      "boot_wait": "1s",
      "boot_keygroup_interval": "1s",
      "boot_command": [
        "<esc><wait><esc><wait><esc><wait><esc><wait>",
        "<esc><wait><esc><wait><esc><wait><esc><wait>",
        "<esc><wait><esc><wait><esc><wait><esc><wait>",
        "<esc><wait><esc><wait><esc><wait><esc><wait>",
        "<esc><wait><esc><wait><esc><wait><esc><wait>",
        "<esc><wait><esc><wait><esc><wait><esc><wait>",
        "<esc><wait><esc><wait><esc><wait><esc><wait>",
        "<bs><bs><bs><bs><bs><bs><bs><bs><bs><bs><bs><bs><bs><bs>",
        "<bs><bs><bs><bs><bs><bs><bs><bs><bs><bs><bs><bs><bs><bs>",
        "boot -s<enter>",
        "<wait10><wait10><wait10>",
        "/bin/sh<enter><wait10>",
        "mdmfs -s 100m md1 /tmp<enter><wait>",
        "mdmfs -s 100m md2 /mnt<enter><wait>",
        "dhclient -l /tmp/dhclient.lease.vtnet0 vtnet0<enter><wait5>",
        "fetch -o /tmp/installerconfig http://{{ .HTTPIP }}:{{ .HTTPPort }}/generic.freebsd14.vagrant.cfg<enter><wait5>",
        "sh -c ' { bsdinstall script /tmp/installerconfig 2>&1 && reboot ; } | tee /tmp/installerconfig.log ' <enter><wait10>"
      ],
      "qemuargs": [
        [
          "-display",
          "gtk"
        ],
        [
          "-device",
          "ramfb"
        ],
        [
          "-machine",
          "virt,gic-version=3,dump-guest-core=off,memory-backend=mach-virt.ram,acpi=on,usb=on"
        ],
        [
          "-object",
          "{'qom-type':'memory-backend-ram','id':'mach-virt.ram','size':4294967296}"
        ],
        [
          "-overcommit",
          "mem-lock=off"
        ],
        [
          "-accel",
          "tcg"
        ],
        [
          "-boot",
          "order=cd,strict=off,menu=off"
        ],
        [
          "-device",
          "qemu-xhci"
        ],
        [
          "-device", 
          "{'driver':'usb-kbd','id':'input0'}"
        ]
      ],
      "efi_boot": true,
      "efi_firmware_code": "/usr/share/edk2/aarch64/QEMU_EFI-silent-pflash.raw",
      "efi_firmware_vars": "/usr/share/edk2/aarch64/vars-template-pflash.raw",
      "format": "qcow2",
      "disk_size": "131072",
      "disk_discard": "unmap",
      "disk_detect_zeroes": "on",
      "disk_cache": "unsafe",
      "disk_image": false,
      "disk_compression": true,
      "disk_interface": "virtio",
      "net_device": "virtio-net",
      "cpus": 4,
      "memory": 4096,
      "http_directory": "http",
      "headless": true,
      "iso_url": "https://ftp.freebsd.org/pub/FreeBSD/releases/ISO-IMAGES/14.0/FreeBSD-14.0-RC4-arm64-aarch64-disc1.iso",
      "iso_checksum": "sha256:41a9163f4adaec848319f914f23879c608fe73ef3d498f1b402494d594e86fa8",
      "ssh_username": "root",
      "ssh_password": "vagrant",
      "ssh_port": 22,
      "ssh_handshake_attempts": 1000,
      "ssh_timeout": "3600s",
      "shutdown_command": "shutdown -p now"
    }
  ],
  "post-processors": [
    [
      {
        "type": "vagrant",
        "compression_level": 9,
        "keep_input_artifact": false,
        "vagrantfile_template": "tpl/generic-{{split build_name \"-\" 1}}.rb",
        "output": "output/generic-{{split build_name \"-\" 1}}-{{split build_name \"-\" 2}}-{{split build_name \"-\" 3}}-{{user `box_version`}}.box",
        "include": [
          "tpl/generic/info.json"
        ]
      },
      {
        "type": "checksum",
        "checksum_types": [
          "sha256"
        ],
        "keep_input_artifact": false,
        "output": "output/generic-{{split build_name \"-\" 1}}-{{split build_name \"-\" 2}}-{{split build_name \"-\" 3}}-{{user `box_version`}}.box.sha256"
      }
    ],
    [
      {
        "type": "vagrant",
        "compression_level": 9,
        "keep_input_artifact": false,
        "vagrantfile_template": "tpl/roboxes-{{split build_name \"-\" 1}}.rb",
        "output": "output/roboxes-{{split build_name \"-\" 1}}-{{split build_name \"-\" 2}}-{{split build_name \"-\" 3}}-{{user `box_version`}}.box",
        "include": [
          "tpl/roboxes/info.json"
        ]
      },
      {
        "type": "checksum",
        "checksum_types": [
          "sha256"
        ],
        "keep_input_artifact": false,
        "output": "output/roboxes-{{split build_name \"-\" 1}}-{{split build_name \"-\" 2}}-{{split build_name \"-\" 3}}-{{user `box_version`}}.box.sha256"
      }
    ]
  ]
}